version: '2'

services:
# Nginx :0  easy way :80 :D 
    web:
        image: nginx:latest
        container_name: allmn_nginx
        ports:
            - "80:80"
            - "443:443"
        volumes:
            - ./nginx/includes.d:/etc/nginx/includes.d # dir usado para includes files nginx config
            - ./nginx/conf.d:/etc/nginx/conf.d
            - /storage:/storage # local dir [projects] remember {find . -type f -exec chmod 544 {} \; && find . -type d -exec chmod 755 {} \;}
        networks:
            - network-front

# PHPs extends file: Ã© a referencia :D assim deixo tudo separado
    php-7:
      extends:
        file: php/php.yml
        service: php-7

    php-5.6:
      extends:
        file: php/php.yml
        service: php-5.6

# BASE DE DADOS MySQL # TODO talvez passar para um .yml separado

    mysql-5.7:
       extends:
        file: mysql/mysql.yml
        service: mysql-5.7

    mysql-5.5:
       extends:
        file: mysql/mysql.yml
        service: mysql-5.5

    percona:
       extends:
        file: mysql/mysql.yml
        service: percona

# USAR extends para Tools ;D
    phpmyadmin:
      extends:
        file: tools/tools.yml
        service: phpmyadmin

    mailhog:
      extends:
        file: tools/tools.yml
        service: mailhog

    redis:
      extends:
        file: tools/tools.yml
        service: redis

# Networks links internos para os services names ;)
networks:
    # basicamente o nginx, e quem precisa dele.
    network-front:
        driver: bridge
    # basicamente o que NAO precisa do nginx.
    network-back:
        driver: bridge